<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Max Kuhn, y Julia Silge">
<title>Modelado Ordenado con R - 12&nbsp; Model Tuning and the Dangers of Overfitting</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./13-grid-search.html" rel="next">
<link href="./11-comparing-models.html" rel="prev">
<link href="./images/cover.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="TMwR.css">
</head>
<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./10-resampling.html">TOOLS FOR CREATING EFFECTIVE MODELS</a></li><li class="breadcrumb-item"><a href="./12-tuning-parameters.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Model Tuning and the Dangers of Overfitting</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Modelado Ordenado con R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/davidrsch/TMwRes" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hello World</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">INTRODUCTION</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-software-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Software for modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">A Tidyverse Primer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-base-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">A Review of R Modeling Fundamentals</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">MODELING BASICS</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-ames.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The Ames Housing Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-data-spending.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Spending our Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-fitting-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Fitting Models with parsnip</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-the-model-workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">A Model Workflow</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-feature-engineering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Feature Engineering with recipes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-judging-model-effectiveness.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Judging Model Effectiveness</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">TOOLS FOR CREATING EFFECTIVE MODELS</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-resampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Resampling for Evaluating Performance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-comparing-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Comparing Models with Resampling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-tuning-parameters.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Model Tuning and the Dangers of Overfitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-grid-search.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Grid Search</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-iterative-search.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Iterative Search</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-workflow-sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Screening Many Models</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">BEYOND THE BASICS</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-dimensionality-reduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Dimensionality Reduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-encoding-categorical-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Encoding Categorical Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-explaining-models-and-predictions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Explaining Models and Predictions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-when-should-you-trust-predictions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">When Should You Trust Your Predictions?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-ensemble-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Ensembles of Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-inferential-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Inferential Analysis</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pre-proc-table.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Recommended Preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#model-parameters" id="toc-model-parameters" class="nav-link active" data-scroll-target="#model-parameters"><span class="header-section-number">12.1</span> Model Parameters</a></li>
  <li><a href="#sec-tuning-parameter-examples" id="toc-sec-tuning-parameter-examples" class="nav-link" data-scroll-target="#sec-tuning-parameter-examples"><span class="header-section-number">12.2</span> Tuning Parameters for Different Types of Models</a></li>
  <li><a href="#sec-what-to-optimize" id="toc-sec-what-to-optimize" class="nav-link" data-scroll-target="#sec-what-to-optimize"><span class="header-section-number">12.3</span> What do we Optimize?</a></li>
  <li><a href="#sec-overfitting-bad" id="toc-sec-overfitting-bad" class="nav-link" data-scroll-target="#sec-overfitting-bad"><span class="header-section-number">12.4</span> The consequences of poor parameter estimates</a></li>
  <li><a href="#two-general-strategies-for-optimization" id="toc-two-general-strategies-for-optimization" class="nav-link" data-scroll-target="#two-general-strategies-for-optimization"><span class="header-section-number">12.5</span> Two general strategies for optimization</a></li>
  <li><a href="#sec-tuning-params-tidymodels" id="toc-sec-tuning-params-tidymodels" class="nav-link" data-scroll-target="#sec-tuning-params-tidymodels"><span class="header-section-number">12.6</span> Tuning Parameters in tidymodels</a></li>
  <li><a href="#chapter-summary" id="toc-chapter-summary" class="nav-link" data-scroll-target="#chapter-summary"><span class="header-section-number">12.7</span> Chapter Summary</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/davidrsch/TMwRes/edit/main/12-tuning-parameters.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/davidrsch/TMwRes/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-tuning" class="quarto-section-identifier"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Model Tuning and the Dangers of Overfitting</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>In order to use a model for prediction, the parameters for that model must be estimated. Some of these parameters can be estimated directly from the training data, but other parameters, called <em>tuning parameters</em> or <em>hyperparameters</em>, must be specified ahead of time and can’t be directly found from training data. These are unknown structural or other kind of values that have significant impact on the model but cannot be directly estimated from the data. This chapter will provide examples of tuning parameters and show how we use tidymodels functions to create and handle tuning parameters. We’ll also demonstrate how poor choices of these values lead to overfitting and introduce several tactics for finding optimal tuning parameters values. Chapters <a href="#sec-grid-search"><span class="quarto-unresolved-ref ref-noprefix">sec-grid-search</span></a> and <a href="#sec-iterative-search"><span class="quarto-unresolved-ref ref-noprefix">sec-iterative-search</span></a> go into more detail on specific optimization methods for tuning.</p>
<section id="model-parameters" class="level2" data-number="12.1"><h2 data-number="12.1" class="anchored" data-anchor-id="model-parameters">
<span class="header-section-number">12.1</span> Model Parameters</h2>
<p>In ordinary linear regression, there are two parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> of the model:</p>
<p><span class="math display">\[ y_i = \beta_0 + \beta_1 x_i + \epsilon_i\]</span></p>
<p>When we have the outcome (<span class="math inline">\(y\)</span>) and predictor (<span class="math inline">\(x\)</span>) data, we can estimate the two parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>:</p>
<p><span class="math display">\[\hat \beta_1 = \frac{\sum_i (y_i-\bar{y})(x_i-\bar{x})}{\sum_i(x_i-\bar{x})^2}\]</span></p>
<p>and</p>
<p><span class="math display">\[\hat \beta_0 = \bar{y}-\hat \beta_1 \bar{x}.\]</span></p>
<p>We can directly estimate these values from the data for this example model because they are analytically tractable; if we have the data, then we can estimate these model parameters.</p>
<div class="rmdnote">
<p>There are many situations where a model has parameters that <em>can’t</em> be directly estimated from the data.</p>
</div>
<p>For the KNN model, the prediction equation for a new value <span class="math inline">\(x_0\)</span> is</p>
<p><span class="math display">\[\hat y = \frac{1}{K}\sum_{\ell = 1}^K x_\ell^*\]</span></p>
<p>where <span class="math inline">\(K\)</span> is the number of neighbors and the <span class="math inline">\(x_\ell^*\)</span> are the <span class="math inline">\(K\)</span> closest values to <span class="math inline">\(x_0\)</span> in the training set. The model itself is not defined by a model equation; the previous prediction equation instead defines it. This characteristic, along with the possible intractability of the distance measure, makes it impossible to create a set of equations that can be solved for <span class="math inline">\(K\)</span> (iteratively or otherwise). The number of neighbors has a profound impact on the model; it governs the flexibility of the class boundary. For small values of <span class="math inline">\(K\)</span>, the boundary is very elaborate while for large values, it might be quite smooth.</p>
<p>The number of nearest neighbors is a good example of a tuning parameter or hyperparameter that cannot be directly estimated from the data.</p>
</section><section id="sec-tuning-parameter-examples" class="level2" data-number="12.2"><h2 data-number="12.2" class="anchored" data-anchor-id="sec-tuning-parameter-examples">
<span class="header-section-number">12.2</span> Tuning Parameters for Different Types of Models</h2>
<p>There are many examples of tuning parameters or hyperparameters in different statistical and machine learning models:</p>
<ul>
<li><p>Boosting is an ensemble method that combines a series of base models, each of which is created sequentially and depends on the previous models. The number of boosting iterations is an important tuning parameter that usually requires optimization.</p></li>
<li><p>In the classic single-layer artificial neural network (a.k.a. the multilayer perceptron), the predictors are combined using two or more hidden units. The hidden units are linear combinations of the predictors that are captured in an <em>activation function</em> (typically a nonlinear function, such as a sigmoid). The hidden units are then connected to the outcome units; one outcome unit is used for regression models, and multiple outcome units are required for classification. The number of hidden units and the type of activation function are important structural tuning parameters.</p></li>
<li><p>Modern gradient descent methods are improved by finding the right optimization parameters. Examples of such hyperparameters are learning rates, momentum, and the number of optimization iterations/epochs <span class="citation" data-cites="Goodfellow">(<a href="#ref-Goodfellow" role="doc-biblioref">Goodfellow, Bengio, and Courville 2016</a>)</span>. Neural networks and some ensemble models use gradient descent to estimate the model parameters. While the tuning parameters associated with gradient descent are not structural parameters, they often require tuning.</p></li>
</ul>
<p>In some cases, preprocessing techniques require tuning:</p>
<ul>
<li><p>In principal component analysis, or its supervised cousin called partial least squares, the predictors are replaced with new, artificial features that have better properties related to collinearity. The number of extracted components can be tuned.</p></li>
<li><p>Imputation methods estimate missing predictor values using the complete values of one or more predictors. One effective imputation tool uses <span class="math inline">\(K\)</span>-nearest neighbors of the complete columns to predict the missing value. The number of neighbors modulates the amount of averaging and can be tuned.</p></li>
</ul>
<p>Some classical statistical models also have structural parameters:</p>
<ul>
<li><p>In binary regression, the logit link is commonly used (i.e., logistic regression). Other link functions, such as the probit and complementary log-log, are also available <span class="citation" data-cites="Dobson99">(<a href="#ref-Dobson99" role="doc-biblioref">Dobson 1999</a>)</span>. This example is described in more detail in the <a href="#sec-what-to-optimize"><span class="quarto-unresolved-ref">sec-what-to-optimize</span></a>.</p></li>
<li><p>Non-Bayesian longitudinal and repeated measures models require a specification for the covariance or correlation structure of the data. Options include compound symmetric (a.k.a. exchangeable), autoregressive, Toeplitz, and others <span class="citation" data-cites="littell2000modelling">(<a href="#ref-littell2000modelling" role="doc-biblioref">Littell, Pendergast, and Natarajan 2000</a>)</span>.</p></li>
</ul>
<p>A counterexample where it is inappropriate to tune a parameter is the prior distribution required for Bayesian analysis. The prior encapsulates the analyst’s belief about the distribution of a quantity before evidence or data are taken into account. For example, in <a href="#sec-tidyposterior"><span class="quarto-unresolved-ref">sec-tidyposterior</span></a>, we used a Bayesian ANOVA model, and we were unclear about what the prior should be for the regression parameters (beyond being a symmetric distribution). We chose a t-distribution with one degree of freedom for the prior since it has heavier tails; this reflects our added uncertainty. Our prior beliefs should not be subject to optimization. Tuning parameters are typically optimized for performance whereas priors should not be tweaked to get “the right results.”</p>
<div class="rmdwarning">
<p>Another (perhaps more debatable) counterexample of a parameter that does <em>not</em> need to be tuned is the number of trees in a random forest or bagging model. This value should instead be chosen to be large enough to ensure numerical stability in the results; tuning it cannot improve performance as long as the value is large enough to produce reliable results. For random forests, this value is typically in the thousands while the number of trees needed for bagging is around 50 to 100.</p>
</div>
</section><section id="sec-what-to-optimize" class="level2" data-number="12.3"><h2 data-number="12.3" class="anchored" data-anchor-id="sec-what-to-optimize">
<span class="header-section-number">12.3</span> What do we Optimize?</h2>
<p>How should we evaluate models when we optimize tuning parameters? It depends on the model and the purpose of the model.</p>
<p>For cases where the statistical properties of the tuning parameter are tractable, common statistical properties can be used as the objective function. For example, in the case of binary logistic regression, the link function can be chosen by maximizing the likelihood or information criteria. However, these statistical properties may not align with the results achieved using accuracy-oriented properties. As an example, <span class="citation" data-cites="FriedmanGFA">Friedman (<a href="#ref-FriedmanGFA" role="doc-biblioref">2001</a>)</span> optimized the number of trees in a boosted tree ensemble and found different results when maximizing the likelihood and accuracy:</p>
<blockquote class="blockquote">
<p>degrading the likelihood by overfitting actually improves misclassification error rate. Although perhaps counterintuitive, this is not a contradiction; likelihood and error rate measure different aspects of fit quality.</p>
</blockquote>
<p>To demonstrate, consider the classification data shown in <a href="#fig-two-class-dat">Figure&nbsp;<span class="quarto-unresolved-ref">fig-two-class-dat</span></a> with two predictors, two classes, and a training set of 593 data points.</p>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/fig-two-class-dat_3dc6cae8570af9cd9958c5e2de70e3e8">
<div class="cell-output-display">
<div id="fig-two-class-dat" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figures/fig-two-class-dat-1.png" class="img-fluid figure-img" alt="An example two-class classification data set with two predictors. The two predictors have a moderate correlation and there is some locations of separation between the classes." width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;12.1: An example two-class classification data set with two predictors</figcaption></figure>
</div>
</div>
</div>
<p>We could start by fitting a linear class boundary to these data. The most common method for doing this is to use a generalized linear model in the form of <em>logistic regression</em>. This model relates the <em>log odds</em> of a sample being Class 1 using the <em>logit</em> transformation:</p>
<p><span class="math display">\[ \log\left(\frac{\pi}{1 - \pi}\right) = \beta_0 + \beta_1x_1 + \ldots + \beta_px_p\]</span></p>
<p>In the context of generalized linear models, the logit function is the <em>link function</em> between the outcome (<span class="math inline">\(\pi\)</span>) and the predictors. There are other link functions that include the <em>probit</em> model:</p>
<p><span class="math display">\[\Phi^{-1}(\pi) = \beta_0 + \beta_1x_1 + \ldots + \beta_px_p\]</span></p>
<p>where <span class="math inline">\(\Phi\)</span> is the cumulative standard normal function, as well as the <em>complementary log-log</em> model:</p>
<p><span class="math display">\[\log(-\log(1-\pi)) = \beta_0 + \beta_1x_1 + \ldots + \beta_px_p\]</span></p>
<p>Each of these models results in linear class boundaries. Which one should we use? Since, for these data, the number of model parameters does not vary, the statistical approach is to compute the (log) likelihood for each model and determine the model with the largest value. Traditionally, the likelihood is computed using the same data that were used to estimate the parameters, not using approaches like data splitting or resampling from Chapters <a href="#sec-splitting"><span class="quarto-unresolved-ref ref-noprefix">sec-splitting</span></a> and <a href="#sec-resampling"><span class="quarto-unresolved-ref ref-noprefix">sec-resampling</span></a>.</p>
<p>For a data frame <code>training_set</code>, let’s create a function to compute the different models and extract the likelihood statistics for the training set (using <code><a href="https://generics.r-lib.org/reference/glance.html">broom::glance()</a></code>):</p>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/tuning-likelihood_a2c62d6f4188554549f0c0ddc9ec2b51">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org">tidymodels</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">llhood</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">logistic_reg</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">set_engine</span><span class="op">(</span><span class="st">"glm"</span>, <span class="va">...</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">fit</span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">training_set</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">glance</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="va">logLik</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">bind_rows</span><span class="op">(</span></span>
<span>  <span class="fu">llhood</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="fu">llhood</span><span class="op">(</span>family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"probit"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">llhood</span><span class="op">(</span>family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"cloglog"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"logit"</span>, <span class="st">"probit"</span>, <span class="st">"c-log-log"</span><span class="op">)</span><span class="op">)</span>  <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">logLik</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 3 × 2</span></span>
<span><span class="co">##   logLik link     </span></span>
<span><span class="co">##    &lt;dbl&gt; &lt;chr&gt;    </span></span>
<span><span class="co">## 1  -258. logit    </span></span>
<span><span class="co">## 2  -262. probit   </span></span>
<span><span class="co">## 3  -270. c-log-log</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>According to these results, the logistic model has the best statistical properties.</p>
<p>From the scale of the log-likelihood values, it is difficult to understand if these differences are important or negligible. One way of improving this analysis is to resample the statistics and separate the modeling data from the data used for performance estimation. With this small data set, repeated 10-fold cross-validation is a good choice for resampling. In the <span class="pkg">yardstick</span> package, the <code>mn_log_loss()</code> function is used to estimate the negative log-likelihood, with our results shown in <a href="#fig-resampled-log-lhood">Figure&nbsp;<span class="quarto-unresolved-ref">fig-resampled-log-lhood</span></a>.</p>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/tuning-resampled-log-lhood_b9ba22bbf7ba1e9ba1dd8dc9a6b905f4">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1201</span><span class="op">)</span></span>
<span><span class="va">rs</span> <span class="op">&lt;-</span> <span class="fu">vfold_cv</span><span class="op">(</span><span class="va">training_set</span>, repeats <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Return the individual resampled performance estimates:</span></span>
<span><span class="va">lloss</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">perf_meas</span> <span class="op">&lt;-</span> <span class="fu">metric_set</span><span class="op">(</span><span class="va">roc_auc</span>, <span class="va">mn_log_loss</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="fu">logistic_reg</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">set_engine</span><span class="op">(</span><span class="st">"glm"</span>, <span class="va">...</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">fit_resamples</span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">A</span> <span class="op">+</span> <span class="va">B</span>, <span class="va">rs</span>, metrics <span class="op">=</span> <span class="va">perf_meas</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">collect_metrics</span><span class="op">(</span>summarize <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">id2</span>, <span class="va">.metric</span>, <span class="va">.estimate</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">resampled_res</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">bind_rows</span><span class="op">(</span></span>
<span>    <span class="fu">lloss</span><span class="op">(</span><span class="op">)</span>                                    <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>model <span class="op">=</span> <span class="st">"logistic"</span><span class="op">)</span>,</span>
<span>    <span class="fu">lloss</span><span class="op">(</span>family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"probit"</span><span class="op">)</span><span class="op">)</span>  <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>model <span class="op">=</span> <span class="st">"probit"</span><span class="op">)</span>,</span>
<span>    <span class="fu">lloss</span><span class="op">(</span>family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"cloglog"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>model <span class="op">=</span> <span class="st">"c-log-log"</span><span class="op">)</span>     </span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># Convert log-loss to log-likelihood:</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>.estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">.metric</span> <span class="op">==</span> <span class="st">"mn_log_loss"</span>, <span class="op">-</span><span class="va">.estimate</span>, <span class="va">.estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">model</span>, <span class="va">.metric</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.estimate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    std_err <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">.estimate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">resampled_res</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">.metric</span> <span class="op">==</span> <span class="st">"mn_log_loss"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">mean</span>, y <span class="op">=</span> <span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">mean</span> <span class="op">-</span> <span class="fl">1.64</span> <span class="op">*</span> <span class="va">std_err</span>, xmax <span class="op">=</span> <span class="va">mean</span> <span class="op">+</span> <span class="fl">1.64</span> <span class="op">*</span> <span class="va">std_err</span><span class="op">)</span>,</span>
<span>                width <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="cn">NULL</span>, x <span class="op">=</span> <span class="st">"log-likelihood"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/fig-resampled-log-lhood_f6c209ebfe5ef7c9b5fdd1a8f9d60afc">
<pre><code>## → A | warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
## There were issues with some computations   A: x1
## There were issues with some computations   A: x1
## </code></pre>
<div class="cell-output-display">
<div id="fig-resampled-log-lhood" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figures/fig-resampled-log-lhood-1.png" class="img-fluid figure-img" alt="Means and approximate 90% confidence intervals for the resampled binomial log-likelihood with three different link functions. The logit link has the largest value, followed by the probit link. The complementary log log link has far lower values." width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;12.2: Means and approximate 90% confidence intervals for the resampled binomial log-likelihood with three different link functions</figcaption></figure>
</div>
</div>
</div>
<div class="rmdnote">
<p>The scale of these values is different than the previous values since they are computed on a smaller data set; the value produced by <code><a href="https://generics.r-lib.org/reference/glance.html">broom::glance()</a></code> is a sum while <code><a href="https://yardstick.tidymodels.org/reference/mn_log_loss.html">yardstick::mn_log_loss()</a></code> is an average.</p>
</div>
<p>These results exhibit evidence that the choice of the link function matters somewhat. Although there is an overlap in the confidence intervals, the logistic model has the best results.</p>
<p>What about a different metric? We also calculated the area under the ROC curve for each resample. These results, which reflect the discriminative ability of the models across numerous probability thresholds, show a lack of difference in <a href="#fig-resampled-roc">Figure&nbsp;<span class="quarto-unresolved-ref">fig-resampled-roc</span></a>.</p>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/fig-resampled-roc_7a2c3f4fd911d8fb73bde59a27678e48">
<div class="cell-output-display">
<div id="fig-resampled-roc" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figures/fig-resampled-roc-1.png" class="img-fluid figure-img" alt="Means and approximate 90% confidence intervals for the resampled area under the ROC curve with three different link functions. The logit link has the largest value, followed by the probit link. The confidence intervals show a large amount of overlap between the two methods." width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;12.3: Means and approximate 90% confidence intervals for the resampled area under the ROC curve with three different link functions</figcaption></figure>
</div>
</div>
</div>
<p>Given the overlap of the intervals, as well as the scale of the x-axis, any of these options could be used. We see this again when the class boundaries for the three models are overlaid on the test set of 198 data points in <a href="#fig-three-link-fits">Figure&nbsp;<span class="quarto-unresolved-ref">fig-three-link-fits</span></a>.</p>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/fig-three-link-fits_cd46fa7a0363447f024f10cf1aeabcb8">
<div class="cell-output-display">
<div id="fig-three-link-fits" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figures/fig-three-link-fits-1.png" class="img-fluid figure-img" alt="The linear class boundary fits for three link functions. The lines have very similar slopes with the complementary log log having a slightly different intercept than the other two links." width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;12.4: The linear class boundary fits for three link functions</figcaption></figure>
</div>
</div>
</div>
<div class="rmdwarning">
<p>This exercise emphasizes that different metrics might lead to different decisions about the choice of tuning parameter values. In this case, one metric indicates the models are somewhat different while another metric shows no difference at all.</p>
</div>
<p>Metric optimization is thoroughly discussed by <span class="citation" data-cites="thomas2020problem">Thomas and Uminsky (<a href="#ref-thomas2020problem" role="doc-biblioref">2020</a>)</span> who explore several issues, including the gaming of metrics. They warn that:</p>
<blockquote class="blockquote">
<p>The unreasonable effectiveness of metric optimization in current AI approaches is a fundamental challenge to the field, and yields an inherent contradiction: solely optimizing metrics leads to far from optimal outcomes.</p>
</blockquote>
</section><section id="sec-overfitting-bad" class="level2" data-number="12.4"><h2 data-number="12.4" class="anchored" data-anchor-id="sec-overfitting-bad">
<span class="header-section-number">12.4</span> The consequences of poor parameter estimates</h2>
<p>Many tuning parameters modulate the amount of model complexity. More complexity often implies more malleability in the patterns that a model can emulate. For example, as shown in <a href="#sec-spline-functions"><span class="quarto-unresolved-ref">sec-spline-functions</span></a>, adding degrees of freedom in a spline function increases the intricacy of the prediction equation. While this is an advantage when the underlying motifs in the data are complex, it can also lead to overinterpretation of chance patterns that would not reproduce in new data. <em>Overfitting</em> is the situation where a model adapts too much to the training data; it performs well for the data used to build the model but poorly for new data.</p>
<div class="rmdwarning">
<p>Since tuning model parameters can increase model complexity, poor choices can lead to overfitting.</p>
</div>
<p>Recall the single layer neural network model described in <a href="#sec-tuning-parameter-examples"><span class="quarto-unresolved-ref">sec-tuning-parameter-examples</span></a>. With a single hidden unit and sigmoidal activation functions, a neural network for classification is, for all intents and purposes, just logistic regression. However, as the number of hidden units increases, so does the complexity of the model. In fact, when the network model uses sigmoidal activation units, <span class="citation" data-cites="cybenko1989approximation">Cybenko (<a href="#ref-cybenko1989approximation" role="doc-biblioref">1989</a>)</span> showed that the model is a universal function approximator as long as there are enough hidden units.</p>
<p>We fit neural network classification models to the same two-class data from the previous section, varying the number of hidden units. Using the area under the ROC curve as a performance metric, the effectiveness of the model on the training set increases as more hidden units are added. The network model thoroughly and meticulously learns the training set. If the model judges itself on the training set ROC value, it prefers many hidden units so that it can nearly eliminate errors.</p>
<p>Chapters <a href="#sec-splitting"><span class="quarto-unresolved-ref ref-noprefix">sec-splitting</span></a> and <a href="#sec-resampling"><span class="quarto-unresolved-ref ref-noprefix">sec-resampling</span></a> demonstrated that simply repredicting the training set is a poor approach to model evaluation. Here, the neural network very quickly begins to overinterpret patterns that it sees in the training set. Compare these three example class boundaries (developed with the training set) overlaid on training and test sets in <a href="#fig-two-class-boundaries">Figure&nbsp;<span class="quarto-unresolved-ref">fig-two-class-boundaries</span></a>.</p>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/fig-two-class-boundaries_32c2cc7f921b6590c8e93aab7494b398">
<div class="cell-output-display">
<div id="fig-two-class-boundaries" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figures/fig-two-class-boundaries-1.png" class="img-fluid figure-img" alt="Class boundaries for three models with increasing numbers of hidden units. The boundaries are fit on the training set and shown for the training and test sets. After a single hidden unit, the boundaries become wildly complex. The test set plots show that the more complex models do not conform to the data that was not used to fit the model." width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;12.5: Class boundaries for three models with increasing numbers of hidden units. The boundaries are fit on the training set and shown for the training and test sets.</figcaption></figure>
</div>
</div>
</div>
<p>The single unit model does not adapt very flexibly to the data (since it is constrained to be linear). A model with four hidden units begins to show signs of overfitting with an unrealistic boundary for values away from the data mainstream. This is caused by a single data point from the first class in the upper-right corner of the data. By 20 hidden units, the model is beginning to memorize the training set, creating small islands around those data to minimize the resubstitution error rate. These patterns do not repeat in the test set. This last panel is the best illustration of how tuning parameters that control complexity must be modulated so that the model is effective. For a 20-unit model, the training set ROC AUC is 0.945 but the test set value is 0.847.</p>
<p>This occurrence of overfitting is obvious with two predictors that we can plot. However, in general, we must use a quantitative approach for detecting overfitting.</p>
<div class="rmdnote">
<p>The solution for detecting when a model is overemphasizing the training set is using out-of-sample data.</p>
</div>
<p>Rather than using the test set, some form of resampling is required. This could mean an iterative approach (e.g., 10-fold cross-validation) or a single data source (e.g., a validation set).</p>
</section><section id="two-general-strategies-for-optimization" class="level2" data-number="12.5"><h2 data-number="12.5" class="anchored" data-anchor-id="two-general-strategies-for-optimization">
<span class="header-section-number">12.5</span> Two general strategies for optimization</h2>
<p>Tuning parameter optimization usually falls into one of two categories: grid search and iterative search.</p>
<p><em>Grid search</em> is when we predefine a set of parameter values to evaluate. The main choices involved in grid search are how to make the grid and how many parameter combinations to evaluate. Grid search is often judged as inefficient since the number of grid points required to cover the parameter space can become unmanageable with the curse of dimensionality. There is truth to this concern, but it is most true when the process is not optimized. This is discussed more in <a href="#sec-grid-search">Chapter&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-grid-search</span></a>.</p>
<p><em>Iterative search</em> or sequential search is when we sequentially discover new parameter combinations based on previous results. Almost any nonlinear optimization method is appropriate, although some are more efficient than others. In some cases, an initial set of results for one or more parameter combinations is required to start the optimization process. Iterative search is discussed more in <a href="#sec-iterative-search">Chapter&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-iterative-search</span></a>.</p>
<p><a href="#fig-tuning-strategies">Figure&nbsp;<span class="quarto-unresolved-ref">fig-tuning-strategies</span></a> shows two panels that demonstrate these two approaches for a situation with two tuning parameters that range between zero and one. In each, a set of contours shows the true (simulated) relationship between the parameters and the outcome. The optimal results are in the upper-right-hand corners.</p>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/fig-tuning-strategies_e11c9949ae7198c2e3e4dffce9686a79">
<div class="cell-output-display">
<div id="fig-tuning-strategies" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figures/fig-tuning-strategies-1.png" class="img-fluid figure-img" alt="Examples of pre-defined grid tuning and an iterative search method. The lines represent contours of some performance metric that is best in the upper-right-hand side of the plot. The grid search shows points that cover the space well and has one point near the optimum. The iterative search method has many more points and meanders to the optimum where many points zero in on the best value." width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;12.6: Examples of pre-defined grid tuning and an iterative search method. The lines represent contours of a performance metric; it is best in the upper-right-hand side of the plot.</figcaption></figure>
</div>
</div>
</div>
<p>The left-hand panel of <a href="#fig-tuning-strategies">Figure&nbsp;<span class="quarto-unresolved-ref">fig-tuning-strategies</span></a> shows a type of grid called a space-filling design. This is a type of experimental design devised for covering the parameter space such that tuning parameter combinations are not close to one another. The results for this design do not place any points exactly at the truly optimal location. However, one point is in the general vicinity and would probably have performance metric results that are within the noise of the most optimal value.</p>
<p>The right-hand panel of <a href="#fig-tuning-strategies">Figure&nbsp;<span class="quarto-unresolved-ref">fig-tuning-strategies</span></a> illustrates the results of a global search method: the Nelder-Mead simplex method <span class="citation" data-cites="Olsson:1975p3609">(<a href="#ref-Olsson:1975p3609" role="doc-biblioref">Olsson and Nelson 1975</a>)</span>. The starting point is in the lower-left part of the parameter space. The search meanders across the space until it reaches the optimum location, where it strives to come as close as possible to the numerically best value. This particular search method, while effective, is not known for its efficiency; it requires many function evaluations, especially near the optimal values. <a href="#sec-iterative-search">Chapter&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-iterative-search</span></a> discusses more efficient search algorithms.</p>
<div class="rmdnote">
<p>Hybrid strategies are also an option and can work well. After an initial grid search, a sequential optimization can start from the best grid combination.</p>
</div>
<p>Examples of these strategies are discussed in detail in the next two chapters. Before moving on, let’s learn how to work with tuning parameter objects in tidymodels, using the <span class="pkg">dials</span> package.</p>
</section><section id="sec-tuning-params-tidymodels" class="level2" data-number="12.6"><h2 data-number="12.6" class="anchored" data-anchor-id="sec-tuning-params-tidymodels">
<span class="header-section-number">12.6</span> Tuning Parameters in tidymodels</h2>
<p>We’ve already dealt with quite a number of arguments that correspond to tuning parameters for recipe and model specifications in previous chapters. It is possible to tune:</p>
<ul>
<li><p>the threshold for combining neighborhoods into an “other” category (with argument name <code>threshold</code>) discussed in <a href="#sec-dummies"><span class="quarto-unresolved-ref">sec-dummies</span></a></p></li>
<li><p>the number of degrees of freedom in a natural spline (<code>deg_free</code>, <a href="#sec-spline-functions"><span class="quarto-unresolved-ref">sec-spline-functions</span></a>)</p></li>
<li><p>the number of data points required to execute a split in a tree-based model (<code>min_n</code>, <a href="#sec-create-a-model"><span class="quarto-unresolved-ref">sec-create-a-model</span></a>)</p></li>
<li><p>the amount of regularization in penalized models (<code>penalty</code>, <a href="#sec-create-a-model"><span class="quarto-unresolved-ref">sec-create-a-model</span></a>)</p></li>
</ul>
<p>For <span class="pkg">parsnip</span> model specifications, there are two kinds of parameter arguments. <em>Main arguments</em> are those that are most often optimized for performance and are available in multiple engines. The main tuning parameters are top-level arguments to the model specification function. For example, the <code>rand_forest()</code> function has main arguments <code>trees</code>, <code>min_n</code>, and <code>mtry</code> since these are most frequently specified or optimized.</p>
<p>A secondary set of tuning parameters are <em>engine specific</em>. These are either infrequently optimized or are specific only to certain engines. Again using random forests as an example, the <span class="pkg">ranger</span> package contains some arguments that are not used by other packages. One example is gain penalization, which regularizes the predictor selection in the tree induction process. This parameter can help modulate the trade-off between the number of predictors used in the ensemble and performance <span class="citation" data-cites="wundervald2020generalizing">(<a href="#ref-wundervald2020generalizing" role="doc-biblioref">Wundervald, Parnell, and Domijan 2020</a>)</span>. The name of this argument in <code>ranger()</code> is <code>regularization.factor</code>. To specify a value via a <span class="pkg">parsnip</span> model specification, it is added as a supplemental argument to <code>set_engine()</code>:</p>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/tuning-args_e7dec5c1727fd7b5bf829d03300247b0">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">rand_forest</span><span class="op">(</span>trees <span class="op">=</span> <span class="fl">2000</span>, min_n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span>                   <span class="co"># &lt;- main arguments</span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"ranger"</span>, regularization.factor <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>         <span class="co"># &lt;- engine-specific</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="rmdwarning">
<p>The main arguments use a harmonized naming system to remove inconsistencies across engines while engine-specific arguments do not.</p>
</div>
<p>How can we signal to tidymodels functions which arguments should be optimized? Parameters are marked for tuning by assigning them a value of <code>tune()</code>. For the single layer neural network used in <a href="#sec-overfitting-bad"><span class="quarto-unresolved-ref">sec-overfitting-bad</span></a>, the number of hidden units is designated for tuning using:</p>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/tuning-mlp-units_80a4df1c98a39ef5c23023af463a85fe">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">neural_net_spec</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">mlp</span><span class="op">(</span>hidden_units <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">set_mode</span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"keras"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>tune()</code> function doesn’t execute any particular parameter value; it only returns an expression:</p>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/tuning-tune-exprs_8baaf204113a3c41856e714855eb528c">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tune</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## tune()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Embedding this <code>tune()</code> value in an argument will tag the parameter for optimization. The model tuning functions shown in the next two chapters parse the model specification and/or recipe to discover the tagged parameters. These functions can automatically configure and process these parameters since they understand their characteristics (e.g., the range of possible values, etc.).</p>
<p>To enumerate the tuning parameters for an object, use the <code>extract_parameter_set_dials()</code> function:</p>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/tuning-mlp-units-param_70ac7d25be89155fc2ca9ee77faf3583">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">extract_parameter_set_dials</span><span class="op">(</span><span class="va">neural_net_spec</span><span class="op">)</span></span>
<span><span class="co">## Collection of 1 parameters for tuning</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    identifier         type    object</span></span>
<span><span class="co">##  hidden_units hidden_units nparam[+]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The results show a value of <code>nparam[+]</code>, indicating that the number of hidden units is a numeric parameter.</p>
<p>There is an optional identification argument that associates a name with the parameters. This can come in handy when the same kind of parameter is being tuned in different places. For example, with the Ames housing data from <a href="#sec-resampling-summary"><span class="quarto-unresolved-ref">sec-resampling-summary</span></a>, the recipe encoded both longitude and latitude with spline functions. If we want to tune the two spline functions to potentially have different levels of smoothness, we call <code>step_ns()</code> twice, once for each predictor. To make the parameters identifiable, the identification argument can take any character string:</p>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/tuning-id_eaa80d3fd683a530c76dca96f5c6ff56">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ames_rec</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">recipe</span><span class="op">(</span><span class="va">Sale_Price</span> <span class="op">~</span> <span class="va">Neighborhood</span> <span class="op">+</span> <span class="va">Gr_Liv_Area</span> <span class="op">+</span> <span class="va">Year_Built</span> <span class="op">+</span> <span class="va">Bldg_Type</span> <span class="op">+</span> </span>
<span>           <span class="va">Latitude</span> <span class="op">+</span> <span class="va">Longitude</span>, data <span class="op">=</span> <span class="va">ames_train</span><span class="op">)</span>  <span class="op">%&gt;%</span></span>
<span>  <span class="fu">step_log</span><span class="op">(</span><span class="va">Gr_Liv_Area</span>, base <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">step_other</span><span class="op">(</span><span class="va">Neighborhood</span>, threshold <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">step_dummy</span><span class="op">(</span><span class="fu">all_nominal_predictors</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">step_interact</span><span class="op">(</span> <span class="op">~</span> <span class="va">Gr_Liv_Area</span><span class="op">:</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"Bldg_Type_"</span><span class="op">)</span> <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">step_ns</span><span class="op">(</span><span class="va">Longitude</span>, deg_free <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="st">"longitude df"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">step_ns</span><span class="op">(</span><span class="va">Latitude</span>,  deg_free <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="st">"latitude df"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">recipes_param</span> <span class="op">&lt;-</span> <span class="fu">extract_parameter_set_dials</span><span class="op">(</span><span class="va">ames_rec</span><span class="op">)</span></span>
<span><span class="va">recipes_param</span></span>
<span><span class="co">## Collection of 3 parameters for tuning</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    identifier      type    object</span></span>
<span><span class="co">##     threshold threshold nparam[+]</span></span>
<span><span class="co">##  longitude df  deg_free nparam[+]</span></span>
<span><span class="co">##   latitude df  deg_free nparam[+]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that the <code>identifier</code> and <code>type</code> columns are not the same for both of the spline parameters.</p>
<p>When a recipe and model specification are combined using a workflow, both sets of parameters are shown:</p>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/tuning-mlp-rec_ba1630c87f7cac0fd93ee53c45b23a21">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">wflow_param</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">add_recipe</span><span class="op">(</span><span class="va">ames_rec</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">add_model</span><span class="op">(</span><span class="va">neural_net_spec</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">extract_parameter_set_dials</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">wflow_param</span></span>
<span><span class="co">## Collection of 4 parameters for tuning</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    identifier         type    object</span></span>
<span><span class="co">##  hidden_units hidden_units nparam[+]</span></span>
<span><span class="co">##     threshold    threshold nparam[+]</span></span>
<span><span class="co">##  longitude df     deg_free nparam[+]</span></span>
<span><span class="co">##   latitude df     deg_free nparam[+]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="rmdwarning">
<p>Neural networks are exquisitely capable of emulating nonlinear patterns. Adding spline terms to this type of model is unnecessary; we combined this model and recipe for illustration only.</p>
</div>
<p>Each tuning parameter argument has a corresponding function in the <span class="pkg">dials</span> package. In the vast majority of the cases, the function has the same name as the parameter argument:</p>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/tuning-dials-unit_330198a7e8e902272d5b9150d7141e42">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">hidden_units</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## # Hidden Units (quantitative)</span></span>
<span><span class="co">## Range: [1, 10]</span></span>
<span><span class="fu">threshold</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## Threshold (quantitative)</span></span>
<span><span class="co">## Range: [0, 1]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>deg_free</code> parameter is a counterexample; the notion of degrees of freedom comes up in a variety of different contexts. When used with splines, there is a specialized <span class="pkg">dials</span> function called <code>spline_degree()</code> that is, by default, invoked for splines:</p>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/tuning-spline-df_653489d28b439fbe7994983b9e898937">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">spline_degree</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## Spline Degrees of Freedom (quantitative)</span></span>
<span><span class="co">## Range: [1, 10]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <span class="pkg">dials</span> package also has a convenience function for extracting a particular parameter object:</p>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/tuning-extract_f857b10b568f4e23eb85a763470ed2cf">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># identify the parameter using the id value:</span></span>
<span><span class="va">wflow_param</span> <span class="op">%&gt;%</span> <span class="fu">extract_parameter_dials</span><span class="op">(</span><span class="st">"threshold"</span><span class="op">)</span></span>
<span><span class="co">## Threshold (quantitative)</span></span>
<span><span class="co">## Range: [0, 0.1]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Inside the parameter set, the range of the parameters can also be updated in place:</p>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/tuning-update_449a91c7d2873ba837894c49e53170c0">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">extract_parameter_set_dials</span><span class="op">(</span><span class="va">ames_rec</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="fu">threshold</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">1.0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Collection of 3 parameters for tuning</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    identifier      type    object</span></span>
<span><span class="co">##     threshold threshold nparam[+]</span></span>
<span><span class="co">##  longitude df  deg_free nparam[+]</span></span>
<span><span class="co">##   latitude df  deg_free nparam[+]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <em>parameter sets</em> created by <code>extract_parameter_set_dials()</code> are consumed by the tidymodels tuning functions (when needed). If the defaults for the tuning parameter objects require modification, a modified parameter set is passed to the appropriate tuning function.</p>
<div class="rmdnote">
<p>Some tuning parameters depend on the dimensions of the data. For example, the number of nearest neighbors must be between one and the number of rows in the data.</p>
</div>
<p>In some cases, it is easy to have reasonable defaults for the range of possible values. In other cases, the parameter range is critical and cannot be assumed. The primary tuning parameter for random forest models is the number of predictor columns that are randomly sampled for each split in the tree, usually denoted as <code>mtry()</code>. Without knowing the number of predictors, this parameter range cannot be preconfigured and requires finalization.</p>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/tuning-rf_bd60cbdf7b88098101a734f5d00f6b3f">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rf_spec</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">rand_forest</span><span class="op">(</span>mtry <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"ranger"</span>, regularization.factor <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="st">"regularization"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">set_mode</span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rf_param</span> <span class="op">&lt;-</span> <span class="fu">extract_parameter_set_dials</span><span class="op">(</span><span class="va">rf_spec</span><span class="op">)</span></span>
<span><span class="va">rf_param</span></span>
<span><span class="co">## Collection of 2 parameters for tuning</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      identifier                  type    object</span></span>
<span><span class="co">##            mtry                  mtry nparam[?]</span></span>
<span><span class="co">##  regularization regularization.factor nparam[+]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model parameters needing finalization:</span></span>
<span><span class="co">##    # Randomly Selected Predictors ('mtry')</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## See `?dials::finalize` or `?dials::update.parameters` for more information.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Complete parameter objects have <code>[+]</code> in their summary; a value of <code>[?]</code> indicates that at least one end of the possible range is missing. There are two methods for handling this. The first is to use <code><a href="https://rdrr.io/r/stats/update.html">update()</a></code>, to add a range based on what you know about the data dimensions:</p>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/tuning-rfupdate_dfa6ed22ad9bfc76ed3f1a9b0cf57a57">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rf_param</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span>mtry <span class="op">=</span> <span class="fu">mtry</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">70</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Collection of 2 parameters for tuning</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      identifier                  type    object</span></span>
<span><span class="co">##            mtry                  mtry nparam[+]</span></span>
<span><span class="co">##  regularization regularization.factor nparam[+]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>However, this approach might not work if a recipe is attached to a workflow that uses steps that either add or subtract columns. If those steps are not slated for tuning, the <code>finalize()</code> function can execute the recipe once to obtain the dimensions:</p>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/tuning-finalize_f6ae029c465ec6f562572d56e4a09b8c">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pca_rec</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">recipe</span><span class="op">(</span><span class="va">Sale_Price</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">ames_train</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Select the square-footage predictors and extract their PCA components:</span></span>
<span>  <span class="fu">step_normalize</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"SF"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Select the number of components needed to capture 95% of</span></span>
<span>  <span class="co"># the variance in the predictors. </span></span>
<span>  <span class="fu">step_pca</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"SF"</span><span class="op">)</span>, threshold <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">updated_param</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">add_model</span><span class="op">(</span><span class="va">rf_spec</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">add_recipe</span><span class="op">(</span><span class="va">pca_rec</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">extract_parameter_set_dials</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">finalize</span><span class="op">(</span><span class="va">ames_train</span><span class="op">)</span></span>
<span><span class="va">updated_param</span></span>
<span><span class="co">## Collection of 2 parameters for tuning</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      identifier                  type    object</span></span>
<span><span class="co">##            mtry                  mtry nparam[+]</span></span>
<span><span class="co">##  regularization regularization.factor nparam[+]</span></span>
<span><span class="va">updated_param</span> <span class="op">%&gt;%</span> <span class="fu">extract_parameter_dials</span><span class="op">(</span><span class="st">"mtry"</span><span class="op">)</span></span>
<span><span class="co">## # Randomly Selected Predictors (quantitative)</span></span>
<span><span class="co">## Range: [1, 74]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When the recipe is prepared, the <code>finalize()</code> function learns to set the upper range of <code>mtry</code> to 74 predictors.</p>
<p>Additionally, the results of <code>extract_parameter_set_dials()</code> will include engine-specific parameters (if any). They are discovered in the same way as the main arguments and included in the parameter set. The <span class="pkg">dials</span> package contains parameter functions for all potentially tunable engine-specific parameters:</p>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/tuning-engine-param-set_efb03a25c2b7bb3a49ff66ec6728ed59">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rf_param</span></span>
<span><span class="co">## Collection of 2 parameters for tuning</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      identifier                  type    object</span></span>
<span><span class="co">##            mtry                  mtry nparam[?]</span></span>
<span><span class="co">##  regularization regularization.factor nparam[+]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model parameters needing finalization:</span></span>
<span><span class="co">##    # Randomly Selected Predictors ('mtry')</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## See `?dials::finalize` or `?dials::update.parameters` for more information.</span></span>
<span><span class="fu">regularization_factor</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## Gain Penalization (quantitative)</span></span>
<span><span class="co">## Range: [0, 1]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, some tuning parameters are best associated with transformations. A good example of this is the penalty parameter associated with many regularized regression models. This parameter is nonnegative and it is common to vary its values in log units. The primary <span class="pkg">dials</span> parameter object indicates that a transformation is used by default:</p>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/tuning-penalty_5ef74c28d4b8d466b640ae77fff3f45d">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">penalty</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## Amount of Regularization (quantitative)</span></span>
<span><span class="co">## Transformer: log-10 [1e-100, Inf]</span></span>
<span><span class="co">## Range (transformed scale): [-10, 0]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is important to know, especially when altering the range. New range values must be in the transformed units:</p>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/tuning-penalty-set_9cce9fed575a46aa5bc868b1ac499e91">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># correct method to have penalty values between 0.1 and 1.0</span></span>
<span><span class="fu">penalty</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">value_sample</span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">##   0.101   0.181   0.327   0.400   0.589   0.999</span></span>
<span></span>
<span><span class="co"># incorrect:</span></span>
<span><span class="fu">penalty</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1.0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">value_sample</span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">##    1.26    2.21    3.68    4.26    5.89   10.00</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The scale can be changed if desired with the <code>trans</code> argument. You can use natural units but the same range:</p>
<div class="cell" data-layout-align="center" data-hash="12-tuning-parameters_cache/html/tuning-penalty-natural_3e3301c319dfedaf45f00adfa3369733">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">penalty</span><span class="op">(</span>trans <span class="op">=</span> <span class="cn">NULL</span>, range <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Amount of Regularization (quantitative)</span></span>
<span><span class="co">## Range: [1e-10, 1]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="chapter-summary" class="level2" data-number="12.7"><h2 data-number="12.7" class="anchored" data-anchor-id="chapter-summary">
<span class="header-section-number">12.7</span> Chapter Summary</h2>
<p>This chapter introduced the process of tuning model hyperparameters that cannot be directly estimated from the data. Tuning such parameters can lead to overfitting, often by allowing a model to grow overly complex, so using resampled data sets together with appropriate metrics for evaluation is important. There are two general strategies for determining the right values, grid search and iterative search, which we will explore in depth in the next two chapters. In tidymodels, the <code>tune()</code> function is used to identify parameters for optimization, and functions from the <span class="pkg">dials</span> package can extract and interact with tuning parameters objects.</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-cybenko1989approximation" class="csl-entry" role="listitem">
Cybenko, G. 1989. <span>“Approximation by Superpositions of a Sigmoidal Function.”</span> <em>Mathematics of Control, Signals and Systems</em> 2 (4): 303–14.
</div>
<div id="ref-Dobson99" class="csl-entry" role="listitem">
Dobson, A. 1999. <em>An Introduction to Generalized Linear Models</em>. Chapman; Hall: Boca Raton.
</div>
<div id="ref-FriedmanGFA" class="csl-entry" role="listitem">
Friedman, J. 2001. <span>“Greedy Function Approximation: A Gradient Boosting Machine.”</span> <em>Annals of Statistics</em> 29 (5): 1189–1232.
</div>
<div id="ref-Goodfellow" class="csl-entry" role="listitem">
Goodfellow, I, Y Bengio, and A Courville. 2016. <em>Deep Learning</em>. MIT Press.
</div>
<div id="ref-littell2000modelling" class="csl-entry" role="listitem">
Littell, R, J Pendergast, and R Natarajan. 2000. <span>“Modelling Covariance Structure in the Analysis of Repeated Measures Data.”</span> <em>Statistics in Medicine</em> 19 (13): 1793–1819.
</div>
<div id="ref-Olsson:1975p3609" class="csl-entry" role="listitem">
Olsson, D, and L Nelson. 1975. <span>“The <span>N</span>elder-<span>M</span>ead Simplex Procedure for Function Minimization.”</span> <em>Technometrics</em> 17 (1): 45–51.
</div>
<div id="ref-thomas2020problem" class="csl-entry" role="listitem">
Thomas, R, and D Uminsky. 2020. <span>“The Problem with Metrics Is a Fundamental Problem for AI.”</span> <a href="https://arxiv.org/abs/2002.08512">https://arxiv.org/abs/2002.08512</a>.
</div>
<div id="ref-wundervald2020generalizing" class="csl-entry" role="listitem">
Wundervald, B, A Parnell, and K Domijan. 2020. <span>“Generalizing Gain Penalization for Feature Selection in Tree-Based Models.”</span> <a href="https://arxiv.org/abs/2006.07515">https://arxiv.org/abs/2006.07515</a>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./11-comparing-models.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Comparing Models with Resampling</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./13-grid-search.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Grid Search</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Modelado Ordenado con R fue escrito por Max Kuhn, y Julia Silge.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Este libro fue creado usando <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>